{
  "hash": "1ab2ac990b150e1e2d6daa5ac9c48e54",
  "result": {
    "engine": "knitr",
    "markdown": "---\ntitle: \"ggplot2 (Grammar)\"\nauthor: \"John Benninghoff\"\ndate: '2022-12-09'\nfile-modified: '2023-11-11'\ncategories: [exercises, ggplot2]\norder: 304\noutput:\n  html_notebook:\n    theme:\n      version: 5\n      preset: bootstrap\n    css: assets/extra.css\n    pandoc_args: --shift-heading-level-by=1\n    toc: yes\n    toc_float:\n      collapsed: yes\n      smooth_scroll: no\n---\n\n\nWorkbook for completing quizzes and exercises from the \"Grammar\" chapters of [ggplot2: Elegant Graphics for Data Analysis](https://ggplot2-book.org/index.html), third edition, with comparisons to solutions from [Solutions to ggplot2: Elegant Graphics for Data Analysis](https://ggplot2-book-solutions-3ed.netlify.app).\n\n\n::: {.cell}\n\n```{.r .cell-code}\nlibrary(MASS) # nolint: unused_import_linter. Used for \"rlm\".\nlibrary(ggplot2)\nlibrary(dplyr)\nlibrary(jbplot)\nlibrary(ggthemes)\n\nknitr::opts_chunk$set(\n  comment = \"#>\",\n  fig.align = \"center\"\n)\n```\n:::\n\n\n# Introduction\n\nThis workbook includes answers and solutions to the quizzes and exercises from [ggplot2: Elegant Graphics for Data Analysis](https://ggplot2-book.org/index.html) and [Solutions to ggplot2: Elegant Graphics for Data Analysis](https://ggplot2-book-solutions-3ed.netlify.app), organized by chapter. It includes excerpts from both books, copied here.\n\n**WARNING, SPOILERS!** If you haven't read the ggplot2 book and intend to complete the quizzes and exercises, don't read this notebook. It contains my (potentially wrong) answers to both.\n\n# 13 Mastering the grammar\n\nIn order to unlock the full power of ggplot2, you'll need to master the underlying grammar. By understanding the grammar, and how its components fit together, you can create a wider range of visualizations, combine multiple sources of data, and customise to your heart's content.\n\nThis chapter describes the theoretical basis of ggplot2: the layered grammar of graphics. The layered grammar is based on Wilkinson's grammar of graphics, but adds a number of enhancements that help it to be more expressive and fit seamlessly into the R environment. The differences between the layered grammar and Wilkinson's grammar are described fully in Hadley Wickham. In this chapter you will learn a little bit about each component of the grammar and how they all fit together.  The next chapters discuss the components in more detail, and provide more examples of how you can use them in practice.\n\nThe grammar makes it easier for you to iteratively update a plot, changing a single feature at a time. The grammar is also useful because it suggests the high-level aspects of a plot that *can* be changed, giving you a framework to think about graphics, and hopefully shortening the distance from mind to paper.  It also encourages the use of graphics customised to a particular problem, rather than relying on specific chart types.\n\n## 13.5 Exercises \n\n-   One of the best ways to get a handle on how the grammar works is to apply\n    it to the analysis of existing graphics. For each of the graphics listed \n    below, write down the components of the graphic. Don't worry if you don't\n    know what the corresponding functions in ggplot2 are called (or if they even\n    exist!), instead focussing on recording the key elements of a plot so you\n    could communicate it to someone else.\n\nAnswer: use the components from 13.4 to describe each plot: data, aesthetics (aes), stat, geom, scale, coordinate system (coord), and faceting\n\n1.  \"Napoleon's march\" by Charles John Minard: [link](http://www.datavis.ca/gallery/re-minard.php)\n\nAnswer: the plot describes Napolean's 1812 campaign. Larger version at: [Wikipedia](https://en.wikipedia.org/wiki/Charles_Joseph_Minard#/media/File:Minard.png)\n\n- data: the size, location and date of the army's travel, along with temperature\n- aes: x, y mapped to location over time, with width representing size\n- stat: no transformation\n- geom: line\n- scale: scales are used for location and temperature\n- coord: Cartesian / map projection\n- facet: no faceting\n\n---\n\n2.  \"Where the Heat and the Thunder Hit Their Shots\", by Jeremy White, \n    Joe Ward, and Matthew Ericson at The New York Times.\n    [link](https://archive.nytimes.com/www.nytimes.com/interactive/2012/06/11/sports/basketball/nba-shot-analysis.html?_r=0)\n\nAnswer: a plot of basketball shots and points scored.\n\n- data: number of attempts and points scored by location\n- aes: x, y mapped to location, size mapped to attempts, color to points scored\n- stat: no transformation (possibly points per attempt)\n- geom: hex tiles\n- scale: continuous scales mapped to location, size (attempts), and color (points)\n- coord: Cartesian, mapped to the court\n- facet: faceting by team and players\n\n---\n\n3.  \"London Cycle Hire Journeys\", by James Cheshire.\n    [link](https://web.archive.org/web/20190523203409/http://spatialanalysis.co.uk/2012/02/great-maps-ggplot2/)\n\nAnswer: retrieved from [archive.org](https://web.archive.org/web/20210516232923/http://spatialanalysis.co.uk/wp-content/uploads/2012/02/bike_ggplot.png).\n\n- data: travels of London bicycle rentals\n- aes: x, y mapped to location, density (alpha) mapped to number of trips in a location\n- stat: none\n- geom: line\n- scale: location\n- coord: Cartesian / map projection\n- facet: none\n\n---\n\n4.  The Pew Research Center's favorite data visualizations of 2014:\n    [link](https://www.pewresearch.org/short-reads/2014/12/29/our-favorite-pew-research-center-data-visualizations-from-2014/)\n\nAnswer: multiple plots, described individually.\n\nPolitical Shifts\n\n- data: responses to political values questions\n- aes: height showing volume of responses, between consistently liberal and conservative\n- stat: histogram\n- geom: area / frequency polygon, with color showing above / below median of the other party\n- scale: continuous\n- coord: Cartesian\n- facet: faceting by party by year\n\nNext America\n\n- data: population by age group and gender\n- aes: binned data by age and gender\n- stat: none\n- geom: bar and color by gender, with boomers a distinct color\n- scale: continuous\n- coord: Cartesian\n- facet: faceting by year, animated\n\n\"Murder Capitals\"\n\n- data: murder rate for six cities, with the highest rate shown for each year, national rate\n- aes: x is time (year) and y is the murder rate\n- stat: none\n- geom: bar, line\n- scale: city is additionally mapped to year at the top of the plot, and national rate is shown as a\n  line across the bottom\n- coord: Cartesian\n- facet: none\n\nIdeological Placement of News Sources\n\n- data: scores of responses to political values questions mapped to audiences for news sources\n- aes: x mapped to score for a news source audience\n- stat: none\n- geom: point\n- scale: a single (x-axis) continuous scale, with labels for each source\n- coord: Cartesian\n- facet: none\n\nRegional Support for Same-Sex Marriage\n\n- data: percentage of population supporting same-sex marriage by region\n- aes: x mapped to time (year), y mapped to percent support\n- stat: none\n- geom: line\n- scale: continuous\n- coord: Cartesian\n- facet: faceting by region, national support is an additional layer\n\n---\n\n5.  \"The Tony's Have Never Been so Dominated by Women\", by \n    Joanna Kao at FiveThirtyEight:\n    [link](https://fivethirtyeight.com/features/the-tonys-have-never-been-so-dominated-by-women/).\n\nAnswer: a plot of Tony award winners by category.\n\n- data: Tony award categories by year with at least one female winner\n- aes: categories along the y axis, years along the x axis, colored red if a female won\n- stat: none\n- geom: square points with color showing female winners\n- scale: discrete categories and years\n- coord: Cartesian\n- facet: none\n\n---\n\n6.  \"In Climbing Income Ladder, Location Matters\" by the Mike Bostock, \n    Shan Carter, Amanda Cox, Matthew Ericson, Josh Keller, Alicia \n    Parlapiano, Kevin Quealy and Josh Williams at the New York Times:\n    [link](https://www.nytimes.com/2013/07/22/business/in-climbing-income-ladder-location-matters.html)\n\nAnswer: not visible due to paywall, unable to retrieve the graphic.\n\n---\n\n7. \"Dissecting a Trailer: The Parts of the Film That Make the Cut\",\n    by Shan Carter, Amanda Cox, and Mike Bostock at the New York Times:\n    [link](https://archive.nytimes.com/www.nytimes.com/interactive/2013/02/19/movies/awardsseason/oscar-trailers.html)\n\nAnswer: multiple plots showing the sequencing of movie trailers.\n\n- data: scenes in a trailer mapped to when they occurred in the full film\n- aes: x axis showing the timestamp of a trailer scene, y axis and color showing when the scene\n  occurred, including scenes not in the final film\n- stat: none\n- geom: square points (with width per scene), connected by lines\n- scale: continuous duration (seconds)\n- coord: Cartesian\n- facet: faceting by trailer (all plots are mapped to the same scale)\n\n---\n\n# 14 Build a plot layer by layer\n\nOne of the key ideas behind ggplot2 is that it allows you to easily iterate, building up a complex plot a layer at a time. Each layer can come from a different dataset and have a different aesthetic mapping, making it possible to create sophisticated plots that display data from multiple sources. \n\nYou've already created layers with functions like `geom_point()` and `geom_histogram()`. In this chapter, you'll dive into the details of a layer, and how you can control all five components: data, the aesthetic mappings, the geom, stat, and position adjustments. The goal here is to give you the tools to build sophisticated plots tailored to the problem at hand.\n\n## 14.3.1 Exercises\n\n1.  The first two arguments to ggplot are `data` and `mapping`. The first\n    two arguments to all layer functions are `mapping` and `data`. Why does the\n    order of the arguments differ? (Hint: think about what you set most \n    commonly.)\n\nAnswer: most plots use common data for all layers, where the aesthetics are more likely to vary.\n\nGG Solutions:\n\n- Commonly, you first set the data in `ggplot()` and then set aesthetics inside your layer functions, like `geom_point()`, `geom_boxplot()`, or `geom_histogram()`. \n\n---\n\n2.  The following code uses dplyr to generate some summary statistics about\n    each class of car. \n\n\n::: {.cell layout-align=\"center\"}\n\n```{.r .cell-code}\nclass <- mpg %>%\n  group_by(class) %>%\n  summarise(n = n(), hwy = mean(hwy))\n```\n:::\n\n\n    Use the data to recreate this plot:\n\nAnswer: with some help from the source code to get the measurements right, here is the solution:\n\n\n::: {.cell layout-align=\"center\"}\n\n```{.r .cell-code}\nggplot(mpg, aes(class, hwy)) +\n  geom_point() +\n  geom_jitter(width = 0.25) +\n  geom_point(data = class, color = \"red\", size = 5) +\n  geom_text(aes(y = 10, label = paste0(\"n = \", n)), data = class, size = 3)\n```\n\n::: {.cell-output-display}\n![](ggplot2-4_files/figure-html/unnamed-chunk-2-1.png){fig-align='center' width=816}\n:::\n:::\n\n\nGG Solutions:\n\n\n::: {.cell layout-align=\"center\"}\n\n```{.r .cell-code}\nmpg %>%\n  ggplot(aes(class, hwy)) +\n  geom_jitter(width = 0.15, height = 0.35) +\n  geom_point(\n    data = class, aes(class, hwy),\n    color = \"red\",\n    size = 6\n  ) +\n  geom_text(data = class, aes(y = 10, x = class, label = paste0(\"n = \", n)))\n```\n\n::: {.cell-output-display}\n![](ggplot2-4_files/figure-html/unnamed-chunk-3-1.png){fig-align='center' width=816}\n:::\n:::\n\n\n- I plotted 3 different layers: jittered points, red point for the summary measure, mean, and text for the sample size (n).\n\n---\n\n## 14.4.3 Exercises\n\n1.  Simplify the following plot specifications:\n\n\n::: {.cell layout-align=\"center\"}\n\n```{.r .cell-code}\nggplot(mpg) +\n  geom_point(aes(mpg$displ, mpg$hwy))\n\nggplot() +\n  geom_point(mapping = aes(y = hwy, x = cty), data = mpg) +\n  geom_smooth(data = mpg, mapping = aes(cty, hwy))\n\nggplot(diamonds, aes(carat, price)) +\n  geom_point(aes(log(brainwt), log(bodywt)), data = msleep)\n```\n:::\n\n\nAnswer:\n\n\n::: {.cell layout-align=\"center\"}\n\n```{.r .cell-code}\nggplot(mpg, aes(displ, hwy)) +\n  geom_point()\n```\n\n::: {.cell-output-display}\n![](ggplot2-4_files/figure-html/unnamed-chunk-5-1.png){fig-align='center' width=816}\n:::\n\n```{.r .cell-code}\nggplot(mpg, aes(cty, hwy)) +\n  geom_point() +\n  geom_smooth(method = \"loess\", formula = y ~ x)\n```\n\n::: {.cell-output-display}\n![](ggplot2-4_files/figure-html/unnamed-chunk-5-2.png){fig-align='center' width=816}\n:::\n\n```{.r .cell-code}\nggplot(msleep, aes(log(brainwt), log(bodywt))) +\n  geom_point(na.rm = TRUE)\n```\n\n::: {.cell-output-display}\n![](ggplot2-4_files/figure-html/unnamed-chunk-5-3.png){fig-align='center' width=816}\n:::\n:::\n\n\nGG Solutions offers a similar solution for the first two and a strange solution for the third (since the `diamonds` data is never used in the third plot):\n\n\n::: {.cell layout-align=\"center\"}\n\n```{.r .cell-code}\nggplot(mpg) +\n  geom_point(aes(displ, hwy))\n\nggplot(mpg, aes(cty, hwy)) +\n  geom_point() +\n  geom_smooth()\n\nmsleep_processed <- msleep %>%\n  mutate(\n    brainwt_log = log(brainwt),\n    bodywt_log = log(bodywt)\n  )\n\nggplot(diamonds, aes(carat, price)) +\n  geom_point(aes(brainwt_log, bodywt_log),\n    data = msleep_processed\n  )\n```\n:::\n\n\nNote: I prefer my answer to GG Solutions.\n\n---\n\n2.  What does the following code do? Does it work? Does it make sense?\n    Why/why not?\n\n\n::: {.cell layout-align=\"center\"}\n\n```{.r .cell-code}\nggplot(mpg) +\n  geom_point(aes(class, cty)) +\n  geom_boxplot(aes(trans, hwy))\n```\n:::\n\n\nAnswer: it does work, but does not make sense, and should be done as separate plots so that the variables comparisons are visible:\n\n\n::: {.cell layout-align=\"center\"}\n\n```{.r .cell-code}\nggplot(mpg, aes(class, cty)) +\n  geom_point() +\n  coord_flip()\n```\n\n::: {.cell-output-display}\n![](ggplot2-4_files/figure-html/unnamed-chunk-8-1.png){fig-align='center' width=816}\n:::\n\n```{.r .cell-code}\nggplot(mpg, aes(trans, hwy)) +\n  geom_boxplot() +\n  coord_flip()\n```\n\n::: {.cell-output-display}\n![](ggplot2-4_files/figure-html/unnamed-chunk-8-2.png){fig-align='center' width=816}\n:::\n:::\n\n\nGG Solutions:\n\n- It plots points of `class` vs `cty` and then a boxplot of `trans` vs `hwy`. It doesn't make sense to plot layers with different `x` and `y` variables.\n\n---\n\n3.  What happens if you try to use a continuous variable on the x axis in \n    one layer, and a categorical variable in another layer? What happens if \n    you do it in the opposite order?\n\nAnswer: let's experiment!\n\nThis code throws an error, `Error: Discrete value supplied to continuous scale`\n\n\n::: {.cell layout-align=\"center\"}\n\n```{.r .cell-code}\nggplot(mpg, aes(displ, hwy)) +\n  geom_point() +\n  geom_point(aes(drv, hwy), color = \"red\")\n```\n:::\n\n\nReversing the order works, but draws a strange plot:\n\n\n::: {.cell layout-align=\"center\"}\n\n```{.r .cell-code}\nggplot(mpg, aes(displ, hwy)) +\n  geom_point(aes(drv, hwy), color = \"red\") +\n  geom_point()\n```\n\n::: {.cell-output-display}\n![](ggplot2-4_files/figure-html/unnamed-chunk-10-1.png){fig-align='center' width=816}\n:::\n:::\n\n\nGG Solutions:\n\n- Not sure\n\n---\n\n## 14.5.1 Exercises\n\n1.  Download and print out the ggplot2 cheatsheet from \n    [rstudio](http://www.rstudio.com/resources/cheatsheets/) so you have a handy visual\n    reference for all the geoms.\n\nAnswer: cheatsheets have moved to [posit](https://posit.co/resources/cheatsheets/) (as the company rebranded).\n\n---\n\n2.  Look at the documentation for the graphical primitive geoms. Which\n    aesthetics do they use? How can you summarise them in a compact form?\n\nAnswer: from 14.5, the primitives are:\n\n- `geom_blank()`: no aesthetics, \"draw nothing\"\n- `geom_point()`: **`x`**, **`y`**, `alpha`, `color`, `fill`, `group`, `shape`, `size`, `stroke`,\n  \"draw points\"\n- `geom_path()`: **`x`**, **`y`**, `alpha`, `color`, `group`, `linetype`, `linewidth`,\n  \"connect observations\"\n- `geom_ribbon()`: **`x` or `y`**, **`ymin` or `xmin`**, **`ymax` or `xmax`**, `alpha`, `color`,\n  `fill`, `group`, `linetype`, `linewidth`, \"draw an area along a line\"\n- `geom_segment()`: **`x`**, **`y`**, **`xend`**, **`yend`**, `alpha`, `color`, `group`, `linetype`,\n  `linewidth`, \"connect two points\"\n- `geom_rect()`: **`x`**, **`y`**, `alpha`, `color`, `fill`, `group`, `height`, `linetype`,\n  `linewidth`, `width`, \"draw rectangles\"\n- `geom_polygon()`: **`x`**, **`y`**, `alpha`, `color`, `fill`, `group`, `linetype`, `linewidth`,\n  `subgroup`, \"draw polygons\"\n- `geom_text()`: **`x`**, **`y`**, **`label`**, `alpha`, `angle`, `color`, `family`, `fontface`,\n  `group`, `hjust`, `lineheight`, `size`, `vjust`, \"draw text\"\n\n---\n\n3.  What's the best way to master an unfamiliar geom? List three resources\n    to help you get started.\n\nAnswer:\n\n- R Documentation for ggplot2, either built-in or [online](https://ggplot2.tidyverse.org)\n- Posit [cheatsheets](https://posit.co/resources/cheatsheets/)\n- The [R Graph Gallery](https://r-graph-gallery.com)\n\n---\n\n4.  For each of the plots below, identify the geom used to draw it.\n\nAnswer: in the order they appear in the [Exercises](https://ggplot2-book.org/layers.html#exercises-11):\n\n1. `geom_violin`\n1. `geom_point` (actually uses `geom_count`)\n1. `geom_hex`\n1. `geom_point` (actually uses `geom_jitter`)\n1. `geom_area`\n1. `geom_path`\n\nNote: verifying my answers against the [source code](https://github.com/hadley/ggplot2-book/blob/main/layers.qmd), I got two wrong, although the underlying geom is `geom_point`.\n\nGG Solutions:\n\nStarting from top left, clockwise direction:\n\n- `geom_violin()`, `geom_point()`, `geom_point()`, `geom_path()`, `geom_area()`, `geom_hex()`.\n\nNote: GG Solutions makes the same mistakes I did.\n\n---\n\n5.  For each of the following problems, suggest a useful geom:\n\n    * Display how a variable has changed over time.\n    * Show the detailed distribution of a single variable.\n    * Focus attention on the overall trend in a large dataset.\n    * Draw a map.\n    * Label outlying points.\n\nAnswers below:\n\n- Display how a variable has changed over time: `geom_line`, with time on the x axis, or `geom_path`\n  to show changes in two dimensions over time.\n- Show the detailed distribution of a single variable: one of the distribution plots,\n  `geom_histogram` and `geom_dotplot` are good choices.\n- Focus attention on the overall trend in a large dataset: `geom_smooth`.\n- Draw a map: `geom_map` or its successor, `geom_sf`.\n- Label outlying points: `geom_text` or `geom_label`.\n\n---\n\n## 14.6.2 Exercises\n\n1.  The code below creates a similar dataset to `stat_smooth()`. Use \n    the appropriate geoms to mimic the default `geom_smooth()` display.\n\n\n::: {.cell layout-align=\"center\"}\n\n```{.r .cell-code}\nmod <- loess(hwy ~ displ, data = mpg)\nsmoothed <- data.frame(displ = seq(1.6, 7, length.out = 50))\npred <- predict(mod, newdata = smoothed, se = TRUE)\nsmoothed$hwy <- pred$fit\nsmoothed$hwy_lwr <- pred$fit - 1.96 * pred$se.fit\nsmoothed$hwy_upr <- pred$fit + 1.96 * pred$se.fit\n```\n:::\n\n\nAnswer: the exercise is to replicate `geom_smooth` using the `smoothed` data frame, which includes a line and a ribbon:\n\n\n::: {.cell layout-align=\"center\"}\n\n```{.r .cell-code}\nggplot(mpg, aes(displ, hwy)) +\n  geom_point() +\n  geom_smooth(method = \"loess\", formula = y ~ x)\n```\n\n::: {.cell-output-display}\n![](ggplot2-4_files/figure-html/unnamed-chunk-12-1.png){fig-align='center' width=816}\n:::\n\n```{.r .cell-code}\nggplot(mpg, aes(displ, hwy)) +\n  geom_point() +\n  geom_line(data = smoothed, color = \"blue\", linewidth = 1) +\n  geom_ribbon(mapping = aes(ymin = hwy_lwr, ymax = hwy_upr), data = smoothed, alpha = 0.2)\n```\n\n::: {.cell-output-display}\n![](ggplot2-4_files/figure-html/unnamed-chunk-12-2.png){fig-align='center' width=816}\n:::\n:::\n\n\nA perfect match!\n\nGG Solutions:\n\n\n::: {.cell layout-align=\"center\"}\n\n```{.r .cell-code}\nsmoothed %>%\n  ggplot(aes(displ, hwy)) +\n  geom_line(color = \"dodgerblue1\") +\n  geom_ribbon(aes(ymin = hwy_lwr, ymax = hwy_upr), alpha = 0.4)\n```\n\n::: {.cell-output-display}\n![](ggplot2-4_files/figure-html/unnamed-chunk-13-1.png){fig-align='center' width=816}\n:::\n:::\n\n\n---\n\n2.  What stats were used to create the following plots?\n\nAnswer: in the order they appear in the [Exercises](https://ggplot2-book.org/layers.html#exercises-12):\n\n1. `stat_ecdf`\n1. `stat_qq`\n1. `stat_density`\n\nConfirmed correct by reviewing the [source code](https://github.com/hadley/ggplot2-book/blob/main/layers.qmd).\n\nGG Solutions: From left to right,\n\n`stat_ecdf()`, `stat_qq()`, `stat_function()`\n\n---\n\n3.  Read the help for `stat_sum()` then use `geom_count()` to create a plot\n    that shows the proportion of cars that have each combination of `drv` and \n    `trans`.\n\nAnswer: in addition, facet by year.\n\n\n::: {.cell layout-align=\"center\"}\n\n```{.r .cell-code}\nggplot(mpg, aes(drv, trans)) +\n  geom_count(aes(size = after_stat(prop), group = 1)) +\n  scale_size(labels = scales::label_percent()) +\n  facet_wrap(vars(year)) +\n  labs(title = \"Combinations of drive train and transmissions\", x = NULL, y = NULL) +\n  labs(size = \"% of cars\") +\n  theme_quo()\n```\n\n::: {.cell-output .cell-output-stderr}\n\n```\n#> Warning in vp$just: partial match of 'just' to 'justification'\n```\n\n\n:::\n\n::: {.cell-output-display}\n![](ggplot2-4_files/figure-html/unnamed-chunk-14-1.png){fig-align='center' width=816}\n:::\n:::\n\n\nGG Solutions:\n\n\n::: {.cell layout-align=\"center\"}\n\n```{.r .cell-code}\nmpg %>%\n  ggplot(aes(drv, trans)) +\n  geom_count(aes(size = after_stat(prop), group = 1))\n```\n\n::: {.cell-output .cell-output-stderr}\n\n```\n#> Warning in vp$just: partial match of 'just' to 'justification'\n```\n\n\n:::\n\n::: {.cell-output-display}\n![](ggplot2-4_files/figure-html/unnamed-chunk-15-1.png){fig-align='center' width=816}\n:::\n:::\n\n\n---\n\n## 14.7.1 Exercises\n\n1.  When might you use `position_nudge()`? Read the documentation.\n\nAnswer: as the documentation states, \"Nudging is built in to `geom_text()` because it's so useful for moving labels a small distance from what they're labelling.\"\n\nGG Solutions: According to the help page, `position_nudge()` is generally useful for adjusting the position of items on discrete scales by a small amount. Nudging is built in to geom_text() because it's so useful for moving labels a small distance from what they're labelling.\n\n---\n\n2.  Many position adjustments can only be used with a few geoms. For example,\n    you can't stack boxplots or errors bars. Why not? What properties must a \n    geom possess in order to be stackable? What properties must it possess\n    to be dodgeable?\n\nAnswer: reading the docs, `position_stack()` requires that geoms have a position (points, lines, text) or a dimension (bar, area). Boxplots and error bars can't be stacked since they don't have a position or area. A geom must have a width in order to be dodgeable, which can be set with `position_dodge(width = ...)`.\n\nGG Solutions: Not sure\n\n---\n\n3.  Why might you use `geom_jitter()` instead of `geom_count()`? What are\n    the advantages and disadvantages of each technique?\n\nAnswer: `geom_jitter()` preserves the size and number of points but not position, and `geom_count()` preserves the position but not number or size. `geom_jitter()` can be a better choice when there are few overlapping points. \n\nGG Solutions: `geom_jitter()` adds a small amount of random variation to the location of each point. It is useful for looking at all the overplotted  points. On the other hand, `geom_count()` counts the number of overlapping observations at each location. It is useful for understanding the number of points in a location.\n\n---\n\n4.  When might you use a stacked area plot? What are the advantages and\n    disadvantages compared to a line plot?\n\nAnswer: a stacked area plot is a good way to show the relationship of related variables, showing how parts of a whole change over time, for example, plotting the phases of incident response (mean time to detect, mean time to resolve). It is very similar to a line plot, and makes relative values (proportions) easier to compare and absolute values harder to compare.\n\nGG Solutions: Stacked area plot seems useful when you want to portray an area whereas a line plot seems useful when you just need a line.\n\n---\n\n# 15 Scales and guides\n\nThe scales toolbox in Chapters 10 to 12 provides extensive guidance for how to work with scales, focusing on solving common data visualisation problems. The practical goals of the toolbox mean that topics are introduced when they are most relevant: for example, scale transformations are discussed in relation to continuous position scales (Section 10.1.7) because that is the most common situation in which you might want to transform a scale. However, because ggplot2 aims to provide a grammar of graphics, there is nothing preventing you from transforming other kinds of scales (see Section 15.6). This chapter aims to illustrate these concepts: I'll discuss the theory underpinning scales and guides, and give examples showing how concepts that I've discussed specifically for position or colour scales also apply elsewhere.\n\n## Setting color with limits\n\nLet's create a pair of plots controlling color with limits (from 11.3.5)! First, we'll just plot both independently:\n\n\n::: {.cell layout-align=\"center\"}\n\n```{.r .cell-code}\ngg_99 <- mpg |>\n  filter(year == 1999) |>\n  ggplot(aes(displ, hwy, color = fl)) +\n  geom_point()\n\ngg_08 <- mpg |>\n  filter(year == 2008) |>\n  ggplot(aes(displ, hwy, color = fl)) +\n  geom_point()\n\ngg_99\n```\n\n::: {.cell-output .cell-output-stderr}\n\n```\n#> Warning in vp$just: partial match of 'just' to 'justification'\n```\n\n\n:::\n\n::: {.cell-output-display}\n![](ggplot2-4_files/figure-html/unnamed-chunk-16-1.png){fig-align='center' width=816}\n:::\n\n```{.r .cell-code}\ngg_08\n```\n\n::: {.cell-output .cell-output-stderr}\n\n```\n#> Warning in vp$just: partial match of 'just' to 'justification'\n```\n\n\n:::\n\n::: {.cell-output-display}\n![](ggplot2-4_files/figure-html/unnamed-chunk-16-2.png){fig-align='center' width=816}\n:::\n:::\n\n\nNow, let's replot using limits:\n\n\n::: {.cell layout-align=\"center\"}\n\n```{.r .cell-code}\ngg_99 +\n  lims(x = c(1, 7), y = c(10, 45)) +\n  scale_color_discrete(\n    limits = c(\"c\", \"d\", \"e\", \"p\", \"r\"),\n    breaks = c(\"d\", \"p\", \"r\"),\n    labels = c(\"diesel\", \"premium\", \"regular\")\n  )\n```\n\n::: {.cell-output .cell-output-stderr}\n\n```\n#> Warning in vp$just: partial match of 'just' to 'justification'\n```\n\n\n:::\n\n::: {.cell-output-display}\n![](ggplot2-4_files/figure-html/unnamed-chunk-17-1.png){fig-align='center' width=816}\n:::\n\n```{.r .cell-code}\ngg_08 +\n  lims(x = c(1, 7), y = c(10, 45)) +\n  scale_color_discrete(\n    limits = c(\"c\", \"d\", \"e\", \"p\", \"r\"),\n    labels = c(\"compressed\", \"diesel\", \"ethanol\", \"premium\", \"regular\")\n  )\n```\n\n::: {.cell-output .cell-output-stderr}\n\n```\n#> Warning in vp$just: partial match of 'just' to 'justification'\n```\n\n\n:::\n\n::: {.cell-output-display}\n![](ggplot2-4_files/figure-html/unnamed-chunk-17-2.png){fig-align='center' width=816}\n:::\n:::\n\n## Key glyphs\n\nLet's use a key glyph! (`draw_key_timeseries()`)\n\n\n::: {.cell layout-align=\"center\"}\n\n```{.r .cell-code}\nggplot(economics, aes(date, psavert, color = \"Personal\\nSavings\\nRate\")) +\n  geom_line(key_glyph = \"timeseries\") +\n  labs(x = NULL, y = NULL, color = NULL) +\n  theme_quo()\n```\n\n::: {.cell-output .cell-output-stderr}\n\n```\n#> Warning in vp$just: partial match of 'just' to 'justification'\n```\n\n\n:::\n\n::: {.cell-output-display}\n![](ggplot2-4_files/figure-html/unnamed-chunk-18-1.png){fig-align='center' width=816}\n:::\n:::\n\n\n# 16 Coordinate systems\n\nCoordinate systems have two main jobs:\n\n* Combine the two position aesthetics to produce a 2d position on the plot.\n  The position aesthetics are called `x` and `y`, but they might be better \n  called position 1 and 2 because their meaning depends on the coordinate \n  system used. For example, with the polar coordinate system they become angle \n  and radius (or radius and angle), and with maps they become latitude and \n  longitude.\n\n* In coordination with the faceter, coordinate systems draw axes and panel\n  backgrounds. While the scales control the values that appear on the axes, and\n  how they map from data to position, it is the coordinate system which \n  actually draws them. This is because their appearance depends on the \n  coordinate system: an angle axis looks quite different than an x axis. \n\n## Polar coordinates\n\nLet's draw a spiral with polar coordinates!\n\n\n::: {.cell layout-align=\"center\"}\n\n```{.r .cell-code}\ndata.frame(x = c(1, 200), y = c(200, 1)) |>\n  ggplot(aes(x, y)) +\n  geom_line() +\n  coord_polar()\n```\n\n::: {.cell-output-display}\n![](ggplot2-4_files/figure-html/unnamed-chunk-19-1.png){fig-align='center' width=816}\n:::\n:::\n\n\nWe can use polar coordinates to draw a pie chart:\n\n\n::: {.cell layout-align=\"center\"}\n\n```{.r .cell-code}\nggplot(mtcars, aes(factor(1), fill = factor(cyl))) +\n  geom_bar(width = 1) +\n  scale_x_discrete(NULL, expand = c(0, 0)) +\n  scale_y_continuous(NULL, expand = c(0, 0)) +\n  coord_polar(theta = \"y\") +\n  labs(title = \"Number of cylinders\", fill = NULL) +\n  theme_void()\n```\n\n::: {.cell-output .cell-output-stderr}\n\n```\n#> Warning in vp$just: partial match of 'just' to 'justification'\n```\n\n\n:::\n\n::: {.cell-output-display}\n![](ggplot2-4_files/figure-html/unnamed-chunk-20-1.png){fig-align='center' width=816}\n:::\n:::\n\n\n# 17 Faceting\n\nYou first encountered faceting in Section 2.5. Faceting generates small multiples each showing a different subset of the data. Small multiples are a powerful tool for exploratory data analysis: you can rapidly compare patterns in different parts of the data and see whether they are the same or different. This section will discuss how you can fine-tune facets, particularly the way in which they interact with position scales.\n\n## Facet grid\n\nLet's draw a facet grid!\n\n\n::: {.cell layout-align=\"center\"}\n\n```{.r .cell-code}\nmpg |>\n  filter(cyl != 5) |>\n  ggplot(aes(displ, hwy)) +\n  geom_point() +\n  geom_smooth(method = \"rlm\", formula = y ~ x) +\n  facet_grid(drv ~ cyl) +\n  labs(x = NULL, y = NULL)\n```\n\n::: {.cell-output-display}\n![](ggplot2-4_files/figure-html/unnamed-chunk-21-1.png){fig-align='center' width=816}\n:::\n:::\n\n\n## Free scales\n\nFree scales are useful when faceting across different variables over the same time period:\n\n\n::: {.cell layout-align=\"center\"}\n\n```{.r .cell-code}\nggplot(economics_long, aes(date, value)) +\n  geom_line() +\n  facet_wrap(~variable, scales = \"free_y\", ncol = 1)\n```\n\n::: {.cell-output-display}\n![](ggplot2-4_files/figure-html/unnamed-chunk-22-1.png){fig-align='center' width=816}\n:::\n:::\n\n\n## Facet space\n\n`facet_grid()` has an additional parameter called `space`, which takes the same values as `scales`.  When space is \"free\", each column (or row) will have width (or height) proportional to the range of the scale for that column (or row).  This makes the scaling equal across the whole plot: 1 cm on each panel maps to the same range of data. (This is somewhat analogous to the 'sliced' axis limits of lattice.) For example, if panel a had range 2 and panel b had range 4, one-third of the space would be given to a, and two-thirds to b. This is most useful for categorical scales, where we can assign space proportionally based on the number of levels in each facet, as illustrated below.\n\n\n::: {.cell layout-align=\"center\"}\n\n```{.r .cell-code}\nmpg2 <- subset(mpg, cyl != 5 & drv %in% c(\"4\", \"f\") & class != \"2seater\")\nmpg2$model <- reorder(mpg2$model, mpg2$cty)\nmpg2$manufacturer <- reorder(mpg2$manufacturer, -mpg2$cty)\n\nggplot(mpg2, aes(cty, model)) +\n  geom_point() +\n  facet_grid(manufacturer ~ ., scales = \"free\", space = \"free\") +\n  labs(x = NULL, y = NULL) +\n  theme(strip.text.y = element_text(angle = 0))\n```\n\n::: {.cell-output-display}\n![](ggplot2-4_files/figure-html/unnamed-chunk-23-1.png){fig-align='center' width=816}\n:::\n:::\n\n\n## Grouping and faceting\n\nLet's combine grouping and faceting!\n\n\n::: {.cell layout-align=\"center\"}\n\n```{.r .cell-code}\nggplot(mpg, aes(displ, hwy)) +\n  geom_point(data = select(mpg, -drv), color = \"grey75\") +\n  geom_point(aes(color = drv)) +\n  facet_wrap(~drv)\n```\n\n::: {.cell-output .cell-output-stderr}\n\n```\n#> Warning in vp$just: partial match of 'just' to 'justification'\n```\n\n\n:::\n\n::: {.cell-output-display}\n![](ggplot2-4_files/figure-html/unnamed-chunk-24-1.png){fig-align='center' width=816}\n:::\n:::\n\n\n## 17.7 Exercises\n\n1.  Diamonds: display the distribution of price conditional\n    on cut and carat. Try faceting by cut and grouping by carat. Try\n    faceting by carat and grouping by cut. Which do you prefer?\n\nAnswer: faceting by caret requires discretizing, here we use `cut_number()`:\n\n\n::: {.cell layout-align=\"center\"}\n\n```{.r .cell-code}\nggplot(diamonds, aes(price, group = carat, color = carat)) +\n  geom_histogram(bins = 100) +\n  scale_color_viridis_c() +\n  facet_wrap(~cut)\n```\n\n::: {.cell-output .cell-output-stderr}\n\n```\n#> Warning in vp$just: partial match of 'just' to 'justification'\n```\n\n\n:::\n\n::: {.cell-output-display}\n![](ggplot2-4_files/figure-html/unnamed-chunk-25-1.png){fig-align='center' width=816}\n:::\n\n```{.r .cell-code}\ndiamonds |>\n  mutate(carat_n = cut_number(carat, 6)) |>\n  ggplot(aes(price, group = cut, fill = cut)) +\n  geom_histogram(bins = 100) +\n  scale_color_viridis_d() +\n  facet_wrap(~carat_n)\n```\n\n::: {.cell-output .cell-output-stderr}\n\n```\n#> Warning in vp$just: partial match of 'just' to 'justification'\n```\n\n\n:::\n\n::: {.cell-output-display}\n![](ggplot2-4_files/figure-html/unnamed-chunk-25-2.png){fig-align='center' width=816}\n:::\n:::\n\n\nFaceting by cut seems preferable, since it provides an insight not provided by faceting by carat: there are more large carat diamonds with a Fair cut.\n\nGG Solutions: takes a different approach, and concludes: \"It makes more sense to facet by cut because its a discrete variable. Faceting by carat, a continuous variable, makes too many facets and renders the plot unreadable!\"\n\n---\n\n2.  Diamonds: compare the relationship between price and carat for\n    each colour. What makes it hard to compare the groups? Is grouping better \n    or faceting? If you use faceting, what annotation might you add to \n    make it easier to see the differences between panels?\n\nAnswer: comparing is hard because of overlap between groups and overplotting. Overall, grouping seems easier to read than faceting. Adding a reference line (in this case, a robust linear regression) makes it easier to see differences across faceting panels.\n\n\n::: {.cell layout-align=\"center\"}\n\n```{.r .cell-code}\nggplot(diamonds, aes(carat, price)) +\n  geom_point(aes(color = color)) +\n  geom_smooth(method = \"rlm\", formula = y ~ x, se = FALSE) +\n  coord_cartesian(ylim = c(0, max(diamonds$price)))\n```\n\n::: {.cell-output .cell-output-stderr}\n\n```\n#> Warning in vp$just: partial match of 'just' to 'justification'\n```\n\n\n:::\n\n::: {.cell-output-display}\n![](ggplot2-4_files/figure-html/unnamed-chunk-26-1.png){fig-align='center' width=816}\n:::\n\n```{.r .cell-code}\nggplot(diamonds, aes(carat, price)) +\n  geom_point(aes(color = color)) +\n  geom_smooth(data = select(diamonds, -color), method = \"rlm\", formula = y ~ x, se = FALSE) +\n  coord_cartesian(ylim = c(0, max(diamonds$price))) +\n  facet_wrap(~color)\n```\n\n::: {.cell-output .cell-output-stderr}\n\n```\n#> Warning in vp$just: partial match of 'just' to 'justification'\n```\n\n\n:::\n\n::: {.cell-output-display}\n![](ggplot2-4_files/figure-html/unnamed-chunk-26-2.png){fig-align='center' width=816}\n:::\n:::\n\n\nGG Solutions:\n\n\n::: {.cell layout-align=\"center\"}\n\n```{.r .cell-code}\ndiamonds %>%\n  ggplot(aes(carat, price)) +\n  geom_point(aes(color = color))\n```\n\n::: {.cell-output .cell-output-stderr}\n\n```\n#> Warning in vp$just: partial match of 'just' to 'justification'\n```\n\n\n:::\n\n::: {.cell-output-display}\n![](ggplot2-4_files/figure-html/unnamed-chunk-27-1.png){fig-align='center' width=816}\n:::\n\n```{.r .cell-code}\ndiamonds %>%\n  ggplot(aes(carat, price)) +\n  geom_point(aes(color = color)) +\n  facet_wrap(~color)\n```\n\n::: {.cell-output .cell-output-stderr}\n\n```\n#> Warning in vp$just: partial match of 'just' to 'justification'\n```\n\n\n:::\n\n::: {.cell-output-display}\n![](ggplot2-4_files/figure-html/unnamed-chunk-27-2.png){fig-align='center' width=816}\n:::\n:::\n\n\n- I think its better to use grouping to compare the different colors. The panels all have the same shape, so it's hard to compare the groups across facets. If I use faceting, I'd add that the plot is facetted by diamond colour, from D (best) to J (worst).\n\n---\n\n3.  Why is `facet_wrap()` generally more useful than `facet_grid()`?\n\nAnswer: when faceting by a single variable, `facet_wrap()` is easier to use as it wraps the facets to fit the plot space automatically. `facet_grid()` is generally more useful only when faceting with two variables.\n\nGG Solutions: I think `facet_wrap()` is more useful than `facet_grid()` because the former function is useful if you have a single variable with many levels and want to arrange the plots in a more space efficient manner. In data analysis, its extremely common to have a single variable with many levels that the analyst wants to arrange the for easy comparison. Although `facet_grid()` works on single variables, `facet_wrap()` involves less typing when you have a single variable.\n\n---\n\n4.  Recreate the following plot. It facets `mpg2` by class, overlaying\n    a smooth curve fit to the full dataset.\n\nAnswer: plot below.\n\n\n::: {.cell layout-align=\"center\"}\n\n```{.r .cell-code}\nggplot(mpg2, aes(displ, hwy)) +\n  geom_point() +\n  geom_smooth(data = select(mpg2, -class), method = \"loess\", formula = y ~ x, se = FALSE) +\n  facet_wrap(~class)\n```\n\n::: {.cell-output-display}\n![](ggplot2-4_files/figure-html/unnamed-chunk-28-1.png){fig-align='center' width=816}\n:::\n:::\n\n\nComparing to the [source code](https://github.com/hadley/ggplot2-book/blob/main/facet.qmd), the answer is correct!\n\nGG Solutions:\n\n\n::: {.cell layout-align=\"center\"}\n\n```{.r .cell-code}\nmpg2 %>%\n  ggplot(aes(displ, hwy)) +\n  geom_point() +\n  geom_smooth(data = mpg2 %>% select(-class), se = FALSE, method = \"loess\") +\n  facet_wrap(~class)\n```\n\n::: {.cell-output .cell-output-stderr}\n\n```\n#> `geom_smooth()` using formula = 'y ~ x'\n```\n\n\n:::\n\n::: {.cell-output-display}\n![](ggplot2-4_files/figure-html/unnamed-chunk-29-1.png){fig-align='center' width=816}\n:::\n:::\n\n\n---\n\n# 18 Themes\n\nIn this chapter you will learn how to use the ggplot2 theme system, which allows you to exercise fine control over the non-data elements of your plot. The theme system does not affect how the data is rendered by geoms, or how it is transformed by scales. Themes don't change the perceptual properties of the plot, but they do help you make the plot aesthetically pleasing or match an existing style guide. Themes give you control over things like fonts, ticks, panel strips, and backgrounds.\n\nThis separation of control into data and non-data parts is quite different from base and lattice graphics. In base and lattice graphics, most functions take a large number of arguments that specify both data and non-data appearance, which makes the functions complicated and harder to learn. ggplot2 takes a different approach: when creating the plot you determine how the data is displayed, then *after* it has been created you can edit every detail of the rendering, using the theming system. \n\n## 18.2.1 Exercises\n\n1.  Try out all the themes in ggthemes. Which do you like the best?\n\nAnswer: the \"interesting\" themes are displayed below. From the top four, I'd pick `theme_solarized_2()`, although `theme_fivethirtyeight()` is a close runner-up.\n\n\n::: {.cell layout-align=\"center\"}\n\n```{.r .cell-code}\nbase <- ggplot(mpg, aes(displ, hwy)) +\n  geom_point(aes(color = factor(cyl))) +\n  geom_smooth(method = \"loess\", formula = y ~ x) +\n  labs(\n    title = \"Fuel economy declines as engine size increases\",\n    subtitle = \"1999-2008\",\n    caption = \"Data from https://fueleconomy.gov/\",\n    x = \"Displacement (liters)\",\n    y = \"Miles per gallon (highway)\",\n    color = \"Cylinders\"\n  )\n\nbase\n```\n\n::: {.cell-output .cell-output-stderr}\n\n```\n#> Warning in vp$just: partial match of 'just' to 'justification'\n```\n\n\n:::\n\n::: {.cell-output-display}\n![](ggplot2-4_files/figure-html/unnamed-chunk-30-1.png){fig-align='center' width=816}\n:::\n\n```{.r .cell-code}\nbase + theme_calc()\n```\n\n::: {.cell-output .cell-output-stderr}\n\n```\n#> Warning in vp$just: partial match of 'just' to 'justification'\n```\n\n\n:::\n\n::: {.cell-output-display}\n![](ggplot2-4_files/figure-html/unnamed-chunk-30-2.png){fig-align='center' width=816}\n:::\n\n```{.r .cell-code}\nbase + theme_fivethirtyeight()\n```\n\n::: {.cell-output .cell-output-stderr}\n\n```\n#> Warning in vp$just: partial match of 'just' to 'justification'\n```\n\n\n:::\n\n::: {.cell-output-display}\n![](ggplot2-4_files/figure-html/unnamed-chunk-30-3.png){fig-align='center' width=816}\n:::\n\n```{.r .cell-code}\nbase + theme_hc()\n```\n\n::: {.cell-output .cell-output-stderr}\n\n```\n#> Warning in vp$just: partial match of 'just' to 'justification'\n```\n\n\n:::\n\n::: {.cell-output-display}\n![](ggplot2-4_files/figure-html/unnamed-chunk-30-4.png){fig-align='center' width=816}\n:::\n\n```{.r .cell-code}\nbase + theme_solarized_2()\n```\n\n::: {.cell-output .cell-output-stderr}\n\n```\n#> Warning in vp$just: partial match of 'just' to 'justification'\n```\n\n\n:::\n\n::: {.cell-output-display}\n![](ggplot2-4_files/figure-html/unnamed-chunk-30-5.png){fig-align='center' width=816}\n:::\n:::\n\n\n---\n\n2.  What aspects of the default theme do you like? What don't you like?   \n    What would you change?\n\nAnswer: my personal theme, `theme_quo()` uses a white background with light gray gridlines (based on `theme_minimal()`), bold titles, captions left-adjusted, and a better font, [Lato](https://www.latofonts.com).\n\n\n::: {.cell layout-align=\"center\"}\n\n```{.r .cell-code}\nbase +\n  theme_quo()\n```\n\n::: {.cell-output .cell-output-stderr}\n\n```\n#> Warning in vp$just: partial match of 'just' to 'justification'\n```\n\n\n:::\n\n::: {.cell-output-display}\n![](ggplot2-4_files/figure-html/unnamed-chunk-31-1.png){fig-align='center' width=816}\n:::\n:::\n\n\n---\n\n3.  Look at the plots in your favourite scientific journal. What theme\n    do they most resemble? What are the main differences?\n\nAnswer: the plots from [this paper](https://doi.org/10.1016/j.ssci.2018.07.021) on *Safety Science* most closely resemble `theme_classic()`, with few differences, the most notable being the position of the legend in Figures 4, 5, 8, and 9.\n\n---\n\n## 18.4.6 Exercises\n\n1.  Create the ugliest plot possible! (Contributed by Andrew D. Steen, \n    University of Tennessee - Knoxville)\n\nAnswer: using the same base, alter colors and theme settings, must still be legible:\n\n\n::: {.cell layout-align=\"center\"}\n\n```{.r .cell-code}\nbase +\n  geom_smooth(method = \"loess\", formula = y ~ x, color = \"orange\", fill = \"limegreen\") +\n  theme_grey(base_family = \"Comic Sans MS\") +\n  theme(\n    plot.background = element_rect(fill = \"skyblue\", color = \"purple\"),\n    plot.title = element_text(face = \"bold\", hjust = 1, color = \"red\"),\n    plot.subtitle = element_text(color = \"yellow\"),\n    plot.caption = element_text(hjust = 0.5, color = \"blue\"),\n    plot.margin = margin(50, 50, 50, 50),\n    axis.line = element_line(color = \"maroon\", linetype = \"dotdash\"),\n    axis.text = element_text(color = \"hotpink\"),\n    axis.title = element_text(color = \"green\"),\n    legend.background = element_rect(fill = \"lemonchiffon\", color = \"gray50\"),\n    legend.key = element_rect(fill = \"pink\", color = \"black\"),\n    legend.text = element_text(color = \"purple\"),\n    legend.title = element_text(color = \"deeppink\"),\n    panel.background = element_rect(fill = \"lavender\"),\n    panel.grid = element_line(linetype = \"twodash\")\n  ) +\n  scale_color_excel()\n```\n\n::: {.cell-output .cell-output-stderr}\n\n```\n#> Warning in vp$just: partial match of 'just' to 'justification'\n```\n\n\n:::\n\n::: {.cell-output-display}\n![](ggplot2-4_files/figure-html/unnamed-chunk-32-1.png){fig-align='center' width=816}\n:::\n:::\n\n\n---\n\n2.  `theme_dark()` makes the inside of the plot dark, but not the \n    outside. Change the plot background to black, and then update the\n    text settings so you can still read the labels.\n\nAnswer:\n\n\n::: {.cell layout-align=\"center\"}\n\n```{.r .cell-code}\nbase +\n  theme_dark() +\n  theme(\n    plot.background = element_rect(fill = \"black\"),\n    legend.background = element_rect(fill = \"black\"),\n    text = element_text(color = \"gray50\")\n  )\n```\n\n::: {.cell-output .cell-output-stderr}\n\n```\n#> Warning in vp$just: partial match of 'just' to 'justification'\n```\n\n\n:::\n\n::: {.cell-output-display}\n![](ggplot2-4_files/figure-html/unnamed-chunk-33-1.png){fig-align='center' width=816}\n:::\n:::\n\n\n---\n\n3.  Make an elegant theme that uses \"linen\" as the background colour and\n    a serif font for the text.\n\nAnswer:\n\n\n::: {.cell layout-align=\"center\"}\n\n```{.r .cell-code}\nbase +\n  theme_minimal(base_family = \"Georgia\") +\n  theme(\n    plot.background = element_rect(fill = \"linen\"),\n    panel.grid.major = element_line(color = \"gray85\"),\n    panel.grid.minor = element_line(color = \"gray90\")\n  )\n```\n\n::: {.cell-output .cell-output-stderr}\n\n```\n#> Warning in vp$just: partial match of 'just' to 'justification'\n```\n\n\n:::\n\n::: {.cell-output-display}\n![](ggplot2-4_files/figure-html/unnamed-chunk-34-1.png){fig-align='center' width=816}\n:::\n:::\n\n\n---\n\n4.  Systematically explore the effects of `hjust` when you have a multiline\n    title. Why doesn't `vjust` do anything?\n\nAnswer: with multiline titles, `hjust` affects both lines in the same way, between left justified (0), centered (0.5), and right justified (1). `vjust` does slightly alter the vertical justification, but not significantly since two lines are just within the vertical margins.\n\n\n::: {.cell layout-align=\"center\"}\n\n```{.r .cell-code}\nmulti <- base +\n  labs(title = \"Fuel economy declines as engine size increases\\n1999-2008\", subtitle = NULL)\n\nmulti + theme(plot.title = element_text(hjust = 0))\n```\n\n::: {.cell-output .cell-output-stderr}\n\n```\n#> Warning in vp$just: partial match of 'just' to 'justification'\n```\n\n\n:::\n\n::: {.cell-output-display}\n![](ggplot2-4_files/figure-html/unnamed-chunk-35-1.png){fig-align='center' width=816}\n:::\n\n```{.r .cell-code}\nmulti + theme(plot.title = element_text(hjust = 0.25))\n```\n\n::: {.cell-output .cell-output-stderr}\n\n```\n#> Warning in vp$just: partial match of 'just' to 'justification'\n```\n\n\n:::\n\n::: {.cell-output-display}\n![](ggplot2-4_files/figure-html/unnamed-chunk-35-2.png){fig-align='center' width=816}\n:::\n\n```{.r .cell-code}\nmulti + theme(plot.title = element_text(hjust = 0.5))\n```\n\n::: {.cell-output .cell-output-stderr}\n\n```\n#> Warning in vp$just: partial match of 'just' to 'justification'\n```\n\n\n:::\n\n::: {.cell-output-display}\n![](ggplot2-4_files/figure-html/unnamed-chunk-35-3.png){fig-align='center' width=816}\n:::\n\n```{.r .cell-code}\nmulti + theme(plot.title = element_text(hjust = 1))\n```\n\n::: {.cell-output .cell-output-stderr}\n\n```\n#> Warning in vp$just: partial match of 'just' to 'justification'\n```\n\n\n:::\n\n::: {.cell-output-display}\n![](ggplot2-4_files/figure-html/unnamed-chunk-35-4.png){fig-align='center' width=816}\n:::\n\n```{.r .cell-code}\nmulti + theme(plot.title = element_text(hjust = 1, vjust = 0))\n```\n\n::: {.cell-output .cell-output-stderr}\n\n```\n#> Warning in vp$just: partial match of 'just' to 'justification'\n```\n\n\n:::\n\n::: {.cell-output-display}\n![](ggplot2-4_files/figure-html/unnamed-chunk-35-5.png){fig-align='center' width=816}\n:::\n:::\n\n\n---\n",
    "supporting": [
      "ggplot2-4_files"
    ],
    "filters": [
      "rmarkdown/pagebreak.lua"
    ],
    "includes": {},
    "engineDependencies": {},
    "preserve": {},
    "postProcess": true
  }
}